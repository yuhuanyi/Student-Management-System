{% extends "layout.html" %}

{# 继承自 layout.html 模板，这里开始定义内容块 #}
{% block content %}
    {# 页面容器，设置最大宽度并居中显示 #}
    <div style="max-width: 500px; margin: 0 auto;">
        {# 页面标题，包含图标 #}
        <h1 style="text-align: center; margin-bottom: 30px;">
            <i class="fas fa-chart-bar"></i> 成绩录入
        </h1>

        {# 如果 URL 参数中 success 为 true，则显示录入成功的提示信息 #}
        {% if request.args.get('success') == 'true' %}
        <div class="alert alert-success" role="alert" style="text-align: center;">
            成绩录入成功！
        </div>
        {% endif %}

        {# 创建一个表单，使用 POST 方法提交数据 #}
        <form method="post" class="form" style="background: white; padding: 25px; border-radius: 8px; box-shadow: 0 4px 6px rgba(0,0,0,0.1);">
            {# 学号输入框的表单组 #}
            <div class="form-group">
                {# 学号输入框的标签，包含图标 #}
                <label for="student_id" style="font-weight: bold;">
                    <i class="fas fa-id-card"></i> 学号:
                </label>
                {# 文本输入框，用于输入学号，为必填项 #}
                <input type="text" id="student_id" name="student_id" required
                       {# 如果表单有提交过，显示上次输入的学号，否则为空 #}
                       value="{{ request.form.get('student_id') or '' }}"
                       style="width: 100%; padding: 10px; border: 1px solid #ddd; border-radius: 4px;">
            </div>

            {# 课程 ID 输入框的表单组 #}
            <div class="form-group">
                {# 课程 ID 输入框的标签，包含图标 #}
                <label for="course_id" style="font-weight: bold;">
                    <i class="fas fa-book"></i> 课程ID:
                </label>
                {# 数字输入框，用于输入课程 ID，为必填项 #}
                <input type="number" id="course_id" name="course_id" required
                       style="width: 100%; padding: 10px; border: 1px solid #ddd; border-radius: 4px;">
            </div>

            {# 成绩输入框的表单组 #}
            <div class="form-group">
                {# 成绩输入框的标签，包含图标 #}
                <label for="score" style="font-weight: bold;">
                    <i class="fas fa-chart-bar"></i> 成绩:
                </label>
                {# 数字输入框，用于输入成绩，为必填项 #}
                <input type="number" id="score" name="score" required
                       style="width: 100%; padding: 10px; border: 1px solid #ddd; border-radius: 4px;">
            </div>

            {# 按钮容器，包含录入按钮和清除记忆按钮 #}
            <div style="display: flex; gap: 15px; margin-top: 20px;">
                {# 提交按钮，点击后提交表单进行成绩录入 #}
                <input type="submit" value="录入"
                       style="flex: 1; padding: 12px; background-color: #3498db; color: white; border: none; border-radius: 4px; cursor: pointer;">

                {# 清除记忆按钮 #}
                <button type="button" id="clear-storage"
                        style="flex: 1; padding: 12px; background-color: #e74c3c; color: white; border: none; border-radius: 4px; cursor: pointer;">
                    <i class="fas fa-eraser"></i> 清除记忆
                </button>
            </div>
        </form>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', function() {
            // 获取学号输入框元素
            const studentIdInput = document.getElementById('student_id');

            // 页面加载时，从本地存储中获取上次保存的学生 ID
            const lastStudentId = localStorage.getItem('lastStudentId');
            if (lastStudentId && !studentIdInput.value) {
                // 如果本地存储中有学生 ID 且输入框为空，则自动填充
                studentIdInput.value = lastStudentId;
            }

            // 监听表单提交事件
            document.querySelector('form').addEventListener('submit', function() {
                // 表单提交时，将当前输入的学生 ID 保存到本地存储
                localStorage.setItem('lastStudentId', studentIdInput.value);
            });

            // 监听清除按钮的点击事件
            document.getElementById('clear-storage').addEventListener('click', function() {
                // 从本地存储中移除上次保存的学生 ID
                localStorage.removeItem('lastStudentId');
                // 清空学号输入框
                studentIdInput.value = '';
                // 让学号输入框获得焦点
                studentIdInput.focus();

                // 显示清除成功的提示框
                alert('已清除保存的学生ID');
            });
        });
    </script>

    <style>
        /* 表单组的样式，设置底部外边距 */
        .form-group {
            margin-bottom: 20px;
        }

        /* 标签的样式，设置为块级元素并添加底部外边距 */
        label {
            display: block;
            margin-bottom: 8px;
        }

        /* 提交按钮和清除按钮的过渡效果 */
        input[type="submit"], #clear-storage {
            transition: all 0.3s ease;
        }

        /* 提交按钮悬停时的背景颜色 */
        input[type="submit"]:hover {
            background-color: #2980b9 !important;
        }

        /* 清除按钮悬停时的背景颜色 */
        #clear-storage:hover {
            background-color: #c0392b !important;
        }
    </style>
{% endblock %}